<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>星足跡｜費用試算（正式價）</title>
<style>
  :root{--pri:#2E7D6B;--bg:#F7FBF9;--muted:#566;--r:14px;--shadow:0 8px 24px #0002}
  *{box-sizing:border-box}
  body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Inter,"Noto Sans TC",sans-serif;margin:0;background:var(--bg);color:#223}
  h1{font-size:28px;margin:24px 16px 8px;text-align:left}
  .lead{margin:0 16px 16px;color:#556;line-height:1.6}
  .wrap{max-width:980px;margin:0 auto;padding:0 16px 8px;display:grid;gap:16px;grid-template-columns:1fr 1fr}
  .card{background:#fff;border-radius:var(--r);box-shadow:var(--shadow);padding:16px}
  h3{margin:0 0 8px 0}
  .sub{color:var(--muted);font-size:13px;margin:4px 0 10px}
  .row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  .seg{display:inline-flex;border:1px solid #e5eee9;border-radius:999px;overflow:hidden}
  .seg button{padding:6px 10px;border:0;background:#fff;cursor:pointer;font-weight:600}
  .seg button.active{background:var(--pri);color:#fff}
  input[type=number]{width:100%;padding:10px;border:1px solid:#e6e6e6;border-radius:10px}
  .out{margin-top:10px;padding:12px;border-radius:12px;background:#F7FBF9;border:1px dashed #dbe7e2}
  .price{font-size:22px;font-weight:900;color:#2E7D6B}
  .note{font-size:12px;color:#667}
  .opt{margin-top:8px;font-size:13px}
  label.opt-inline{display:inline-flex;align-items:center;gap:6px;cursor:pointer}
  @media (max-width:900px){.wrap{grid-template-columns:1fr} h1{text-align:center} .lead{text-align:center}}
  .cta-bottom{max-width:980px;margin:0 auto;padding:24px 16px 60px;text-align:center}
  .btn-solid{
    display:inline-block;
    margin:12px auto;
    padding:14px 28px;
    border-radius:999px;
    background:var(--pri);
    color:#fff;
    text-decoration:none;
    font-weight:700;
    font-size:16px;
    box-shadow:var(--shadow);
    transition:all 0.25s ease;
  }
  .btn-solid:hover{background:#256d5f;transform:translateY(-1px)}
</style>
</head>
<body>
  <h1>費用試算（輸入體重｜正式價）</h1>
  <p class="lead">輸入毛孩體重，即時查看水化／火化、個別／團體估價。</p>

  <div id="calc" class="wrap">
    <div class="card" id="aqua">
      <h3>水化（Bio Cremation）</h3>
      <div class="sub">依 <b>實際體重</b> 計價；選擇「個別 / 團體」、是否特寵（≤2kg），並輸入體重（kg）。</div>
      <div class="row">
        <div>
          <div class="seg">
            <button type="button" data-mode="individual" class="active">個別</button>
            <button type="button" data-mode="group">團體</button>
          </div>
          <div class="opt"><label class="opt-inline"><input id="aquaSpecial" type="checkbox"> 特寵（≤2kg）</label></div>
        </div>
        <div><input id="kgA" type="number" step="0.01" min="0.01" placeholder="體重（kg）"></div>
      </div>
      <div class="out">
        <div>試算金額</div>
        <div class="price" id="pA">—</div>
        <div class="note">＊以現場量重與客服確認為準。水化享 10 天免費冰存，超過每日 100 元。</div>
      </div>
    </div>

    <div class="card" id="crem">
      <h3>傳統火化</h3>
      <div class="sub">依 <b>實際體重</b> 計價；選擇「個別 / 團體」、是否特寵（≤2kg），並輸入體重（kg）。</div>
      <div class="row">
        <div>
          <div class="seg">
            <button type="button" data-mode="individual" class="active">個別</button>
            <button type="button" data-mode="group">團體</button>
          </div>
          <div class="opt"><label class="opt-inline"><input id="cremSpecial" type="checkbox"> 特寵（≤2kg）</label></div>
        </div>
        <div><input id="kgC" type="number" step="0.01" min="0.01" placeholder="體重（kg）"></div>
      </div>
      <div class="out">
        <div>試算金額</div>
        <div class="price" id="pC">—</div>
        <div class="note">＊以現場量重與客服確認為準。火化享 10 天免費冰存，超過每日 100 元。</div>
      </div>
    </div>
  </div>

  <div class="cta-bottom">
    <a href="https://www.starfootprint.com.tw/service/4" class="btn-solid">前往價格頁</a>
  </div>

<script>
const TIER = {
  aquamation: {
    individual: [
      {max:1,  price:5000},
      {max:10, price:6500},
      {max:20, price:7500},
      {max:30, price:8500},
      {max:40, price:9500},
    ],
    group: [
      {max:1,  price:1500},
      {max:10, price:2000},
      {max:20, price:3000},
      {max:30, price:3500},
      {max:40, price:4000},
    ],
    over40: {per10kg:1000},
    special: {individual:5000, group:1500}
  },

  cremation: {
    individual: [
      {max:10, price:5000},
      {max:20, price:6000},
      {max:30, price:7000}, // ★ 原本是 max:40，改成 30kg 以內 7,000
    ],
    group: [
      {max:5,  price:1500},
      {max:15, price:2500},
      {max:25, price:3500},
      {max:40, price:4000},
    ],
    over40: {individual:1000, group:500},
    special: {individual:5000, group:5000} // ★ 補上 group，避免特寵+團體出錯
  }
};

const nt = n => "NT$ " + Math.round(n).toLocaleString("zh-TW");
const ceil10 = x => Math.ceil(x / 10);

function calcAquamation(kg, mode, special){
  if(special && kg <= 2) return TIER.aquamation.special[mode];

  for(const t of TIER.aquamation[mode]) if(kg <= t.max) return t.price;

  const base = TIER.aquamation[mode].at(-1).price;
  const extra = ceil10(kg - 40) * TIER.aquamation.over40.per10kg;
  return base + extra;
}

function calcCremation(kg, mode, special){
  if(special && kg <= 2) return TIER.cremation.special[mode];

  // 先看有沒有落在固定級距表裡
  for(const t of TIER.cremation[mode]) {
    if(kg <= t.max) return t.price;
  }

  // ★ 超出級距的加價規則：
  // 個別火化：超過 30kg，每 10kg 加 1,000
  // 團體火化：維持原本設定：超過 40kg，每 10kg 加 500
  const base = TIER.cremation[mode].at(-1).price;
  const extraBaseKg = mode === "individual" ? 30 : 40; // ★ 個別從 30 開始加，團體從 40 開始加
  const rate = mode === "individual"
    ? 1000
    : 500;

  const extra = ceil10(kg - extraBaseKg) * rate;
  return base + extra;
}

function updateA(){
  const kg = parseFloat(document.querySelector("#kgA").value);
  if(!kg){document.querySelector("#pA").textContent="—";return;}
  const mode = document.querySelector("#aqua button.active").dataset.mode;
  const special = document.querySelector("#aquaSpecial").checked;
  document.querySelector("#pA").textContent = nt(calcAquamation(kg, mode, special));
}

function updateC(){
  const kg = parseFloat(document.querySelector("#kgC").value);
  if(!kg){document.querySelector("#pC").textContent="—";return;}
  const mode = document.querySelector("#crem button.active").dataset.mode;
  const special = document.querySelector("#cremSpecial").checked;
  document.querySelector("#pC").textContent = nt(calcCremation(kg, mode, special));
}

document.querySelectorAll("#aqua button").forEach(btn=>{
  btn.addEventListener("click",()=>{
    document.querySelectorAll("#aqua button").forEach(b=>b.classList.remove("active"));
    btn.classList.add("active"); updateA();
  });
});
document.querySelector("#aquaSpecial").addEventListener("change", updateA);
document.querySelector("#kgA").addEventListener("input", updateA);

document.querySelectorAll("#crem button").forEach(btn=>{
  btn.addEventListener("click",()=>{
    document.querySelectorAll("#crem button").forEach(b=>b.classList.remove("active"));
    btn.classList.add("active"); updateC();
  });
});
document.querySelector("#cremSpecial").addEventListener("change", updateC);
document.querySelector("#kgC").addEventListener("input", updateC);
</script>
</body>
</html>
